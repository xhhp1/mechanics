<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ğŸ–‹ Ù…Ø®ØªØµØ± Ø§Ù„Ù…Ø³Ù…ÙŠØ§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØ© ğŸ–‹</title>
<style>
    body {
      background: url("https://raw.githubusercontent.com/xhhp1/mechanics/main/images/mechan.png") no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      font-family: Arial, sans-serif;
      color: white;
      text-align: center;
    }
    h2 {
      margin-top: 20px;
    }
    input, select, button {
      margin: 10px;
      padding: 8px;
      border-radius: 5px;
      border: none;
      font-size: 16px;
    }
    .generate {
      background: #28a745;
      color: white;
      cursor: pointer;
    }
    .generate:hover {
      background: #218838;
    }
    #resultOutput {
      margin-top: 20px;
      padding: 10px;
      background: rgba(0,0,0,0.5);
      border-radius: 10px;
      display: inline-block;
      font-size: 18px;
    }
</style>
<style>
body {
  font-family: Arial, sans-serif;
  background-color: #111;
  color: #e0ca51;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
}
.toggle-buttons {
  display: flex;
  gap: 15px;
  margin-bottom: 20px;
}
.toggle-buttons button {
  padding: 12px 20px;
  font-size: 16px;
  font-weight: bold;
  background: #e0ca51;
  color: #111;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.3s;
}
.toggle-buttons .report-btn {
  padding: 12px 20px;
  font-size: 16px;
  font-weight: bold;
  background: #e0ca51;
  color: #111;
  border-radius: 8px;
  text-decoration: none;
  display: inline-block;
  transition: 0.3s;
}
.toggle-buttons .report-btn:hover {
  background: #c6b142;
}
.toggle-buttons button.active {
  background: #c6b142;
}
.container {
  background-color: #1b1b1b;
  padding: 20px;
  border-radius: 10px;
  width: 400px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.45);
  display: none;
}
.container.active {
  display: block;
}
h1 { text-align: center; margin: 0 0 8px; }
h2 { text-align: center; font-size: 0.95rem; margin: 0 0 12px; }
input, select, button {
  width: 100%;
  padding: 8px 10px;
  margin: 6px 0;
  border-radius: 6px;
  border: none;
  box-sizing: border-box;
}
input, select {
  background: #2b2b2b;
  color: #e0ca51;
  font-size: 14px;
}
button.generate, .copy-btn {
  background: #e0ca51;
  color: #111;
  font-weight: 700;
  cursor: pointer;
}
button.generate:hover, .copy-btn:hover {
  background: #c6b142;
}
label { display: block; font-size: 14px; margin: 6px 0; }
.output {
  background: #333;
  padding: 10px;
  margin-top: 10px;
  border-radius: 6px;
  min-height: 22px;
  color: #e0ca51;
  font-weight: 600;
  word-break: break-word;
}
.copy-btn {
  margin-top: 8px;
  padding: 8px;
  border-radius: 6px;
}
@media (max-width: 880px) {
  .container { width: 100%; max-width: 520px; }
}
</style>
</head>
<body>

<div class="toggle-buttons">
  <button id="fieldBtn" class="active">ØªÙˆØ¬ÙŠÙ‡Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù†</button>
  <button id="jobBtn">ØªÙˆØ¬ÙŠÙ‡Ø§Øª Ø§Ù„ØªÙˆØ¸ÙŠÙ</button>
  <a href="https://xhhp1.github.io/anything/" target="_blank" class="report-btn">ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</a>
</div>

<!-- ØªÙˆØ¬ÙŠÙ‡Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù† -->
<div class="container active" id="fieldContainer">
  <h1>ğŸ›  ØªÙˆØ¬ÙŠÙ‡Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù† ğŸ› </h1>
  <h2>âš™ï¸Ø§Ø®ØªØµØ± Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠâš™ï¸</h2>

  <input type="text" id="nameInputField" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù…Ø«Ø§Ù„ (Ø­Ù…Ø¯ Ø¨Ù† Ø¹Ø³ÙƒØ±)">
  <input type="text" id="numberInputField" placeholder="ÙƒÙˆØ¯Ùƒ Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠ Ù…Ø«Ø§Ù„ (G-110)">

  <select id="rankSelect">
    <option value="">Ø§Ø®ØªØ± Ø±ØªØ¨ØªÙƒ</option>
    <option value="ÙÙ†ÙŠ">ÙÙ†ÙŠ</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ù‡">Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ù‡</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ù‡ Ù…ØªØ¯Ø±Ø¨">Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ù‡ Ù…ØªØ¯Ø±Ø¨</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ">Ø§Ø´Ø±Ø§Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ø¹Ø§Ù…">Ø§Ø´Ø±Ø§Ù Ø¹Ø§Ù…</option>
    <option value="Ø·ÙˆØ§Ø±Ø¦ ÙˆØ¥Ù†Ù‚Ø§Ø° "> Ø·ÙˆØ§Ø±Ø¦ ÙˆØ§Ù†Ù‚Ø§Ø° </option>
  </select>

  <select id="subRegion" style="display:none;">
    <option value="">Ø§Ø®ØªØ± ØªÙˆØ¬ÙŠÙ‡Ùƒ</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ù„ÙˆØ³">Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ù„ÙˆØ³</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø³Ø§Ù†Ø¯ÙŠ">Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø³Ø§Ù†Ø¯ÙŠ</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø¨ÙˆÙ„ÙŠØªÙˆ">Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø¨ÙˆÙ„ÙŠØªÙˆ</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø¨ÙˆÙ„ÙŠØªÙˆ + Ø³Ø§Ù†Ø¯ÙŠ">Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø¨ÙˆÙ„ÙŠØªÙˆ + Ø³Ø§Ù†Ø¯ÙŠ</option>
  </select>

  <select id="subRegionTrainee" style="display:none;">
    <option value="">Ø§Ø®ØªØ± ØªÙˆØ¬ÙŠÙ‡Ùƒ</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ù„ÙˆØ³ Ù…ØªØ¯Ø±Ø¨">Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ù„ÙˆØ³ Ù…ØªØ¯Ø±Ø¨</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø³Ø§Ù†Ø¯ÙŠ Ù…ØªØ¯Ø±Ø¨">Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø³Ø§Ù†Ø¯ÙŠ Ù…ØªØ¯Ø±Ø¨</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø¨ÙˆÙ„ÙŠØªÙˆ Ù…ØªØ¯Ø±Ø¨">Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø¨ÙˆÙ„ÙŠØªÙˆ Ù…ØªØ¯Ø±Ø¨</option>
    <option value="Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø¨ÙˆÙ„ÙŠØªÙˆ + Ø³Ø§Ù†Ø¯ÙŠ Ù…ØªØ¯Ø±Ø¨">Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ø© Ø¨ÙˆÙ„ÙŠØªÙˆ + Ø³Ø§Ù†Ø¯ÙŠ Ù…ØªØ¯Ø±Ø¨</option>
  </select>

  <select id="regionNames" style="display:none;">
    <option value="">Ø§Ø®ØªØ± Ø§Ø³Ù… ØªÙˆØ¬ÙŠÙ‡Ùƒ</option>
    <option value="Ù„ÙˆØ³">Ù„ÙˆØ³</option>
    <option value="Ø³Ø§Ù†Ø¯ÙŠ">Ø³Ø§Ù†Ø¯ÙŠ</option>
    <option value="Ø¨ÙˆÙ„ÙŠØªÙˆ">Ø¨ÙˆÙ„ÙŠØªÙˆ</option>
    <option value="Ø¬Ø²ÙŠØ±Ø©">Ø¬Ø²ÙŠØ±Ø©</option>
    <option value="Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª">Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</option>
    <option value="Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª">Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</option>
    <option value="Ù…Ø±ÙƒØ² Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª">Ù…Ø±ÙƒØ² Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª</option>
  </select>

  <label><input type="checkbox" id="fleetToggle"> Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø§Ù„Ø£Ø³Ø·ÙˆÙ„ØŸ</label>
  <select id="fleetBox" style="display:none;">
    <option value="">Ø§Ø®ØªØ± Ø®Ø¯Ù…Ø© Ø§Ù„Ø§Ø³Ø·ÙˆÙ„</option>
    <option value="Ø§Ø³Ø·ÙˆÙ„ Ù„ÙˆØ³">Ø§Ø³Ø·ÙˆÙ„ Ù„ÙˆØ³</option>
    <option value="Ø§Ø³Ø·ÙˆÙ„ Ø³Ø§Ù†Ø¯ÙŠ">Ø§Ø³Ø·ÙˆÙ„ Ø³Ø§Ù†Ø¯ÙŠ</option>
    <option value="Ø§Ø³Ø·ÙˆÙ„ Ø¨ÙˆÙ„ÙŠØªÙˆ">Ø§Ø³Ø·ÙˆÙ„ Ø¨ÙˆÙ„ÙŠØªÙˆ</option>
    <option value="Ø§Ø³Ø·ÙˆÙ„ Ø¬Ø²ÙŠØ±Ø©">Ø§Ø³Ø·ÙˆÙ„ Ø¬Ø²ÙŠØ±Ø©</option>
    <option value="Ø§Ø³Ø·ÙˆÙ„ Ù…ØªÙˆØ³Ø· Ù„ÙˆØ³">Ø§Ø³Ø·ÙˆÙ„ Ù…ØªÙˆØ³Ø· Ù„ÙˆØ³</option>
    <option value="Ø§Ø³Ø·ÙˆÙ„ Ù…ØªÙˆØ³Ø· Ø³Ø§Ù†Ø¯ÙŠ">Ø§Ø³Ø·ÙˆÙ„ Ù…ØªÙˆØ³Ø· Ø³Ø§Ù†Ø¯ÙŠ</option>
    <option value="Ø§Ø³Ø·ÙˆÙ„ Ù…ØªÙˆØ³Ø· Ø¨ÙˆÙ„ÙŠØªÙˆ">Ø§Ø³Ø·ÙˆÙ„ Ù…ØªÙˆØ³Ø· Ø¨ÙˆÙ„ÙŠØªÙˆ</option>
    <option value="Ø§Ø³Ø·ÙˆÙ„ Ù…ØªÙˆØ³Ø· Ø¬Ø²ÙŠØ±Ø©">Ø§Ø³Ø·ÙˆÙ„ Ù…ØªÙˆØ³Ø· Ø¬Ø²ÙŠØ±Ø©</option>
  </select>
  <label><input type="checkbox" id="minaTech"> ÙÙ†ÙŠ Ù…ÙŠÙ†Ø§Ø¡</label>
  <label><input type="checkbox" id="masarat"> Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ùˆ Ø§Ù„ØªØ²ÙˆÙŠØ¯</label>
  <input type="text" id="masarInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³Ø§Ø± ÙÙ‚Ø· Ù…Ø«Ø§Ù„ (4)" style="display:none;">
  <label><input type="checkbox" id="controlUnit"> ÙˆØ­Ø¯Ø© ØªØ­ÙƒÙ…</label>
  <select id="controlOptions" style="display:none;">
    <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…</option>
    <option value="ÙÙ†ÙŠ Ù…Ø±ÙƒØ² ØªØ­ÙƒÙ…">ÙÙ†ÙŠ Ù…Ø±ÙƒØ² ØªØ­ÙƒÙ…</option>
    <option value="ÙÙ†ÙŠ Ø®Ø¯Ù…Ø§Øª Ø·Ø±Ù‚">ÙÙ†ÙŠ Ø®Ø¯Ù…Ø§Øª Ø·Ø±Ù‚</option>
  </select>

  <!-- ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ -->
  <label><input type="checkbox" id="koodToggle"> ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ </label>
  <select id="koodOptions" style="display:none;">
    <option value="">Ø§Ø®ØªØ± ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯</option>
    <option value="CD">CD</option>
    <option value="CC">CC</option>
    <option value="CB">CB</option>
  </select>

  <button class="generate" onclick="generateResult()">ğŸ— Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ø£Ø¸Ù‡Ø§Ø± Ø§Ø³Ù…Ùƒ ğŸ—</button>
  <div class="output" id="resultOutput"></div>
  <button class="copy-btn" onclick="copyText('resultOutput')">ğŸ”— Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù„Ù†Ø³Ø® ğŸ”—</button>
</div>

<!-- ØªÙˆØ¬ÙŠÙ‡Ø§Øª Ø§Ù„ØªÙˆØ¸ÙŠÙ -->
<div class="container" id="jobContainer">
  <h1>ğŸ“œ ØªÙˆØ¬ÙŠÙ‡Ø§Øª Ø§Ù„ØªÙˆØ¸ÙŠÙğŸ“œ </h1>
  <h2>ğŸ“ŒØ§Ø®ØªØµØ± ØªÙˆØ¬ÙŠÙ‡Ùƒ ÙÙŠ Ø§Ù„ØªÙˆØ¸ÙŠÙ ğŸ“Œ</h2>

  <input type="text" id="nameInput" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù…Ø«Ø§Ù„ (Ø­Ù…Ø¯ Ø¨Ù† Ø¹Ø³ÙƒØ±)">
  <input type="text" id="numberInput" placeholder="ÙƒÙˆØ¯Ùƒ Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠ Ù…Ø«Ø§Ù„ (G-110)">

  <label style="display:block; text-align:right; margin-top:6px">Ø§Ø®ØªØ§Ø± ØªÙˆØ¬ÙŠÙ‡Ùƒ Ø­Ø³Ø¨ Ø§Ù„ØªÙ‚Ø±ÙŠØ±:</label>
  <select id="roleSelect">
    <option value="">Ø§Ø®ØªØ± ØªÙˆØ¬ÙŠÙ‡Ùƒ</option>
    <option>Ù†Ø§Ø¦Ø¨ Ù…Ø¯ÙŠØ± Ù‚Ø³Ù… Ø´Ø¤ÙˆÙ† Ø§Ù„ØªÙˆØ¸ÙŠÙ</option>
    <option>Ø§Ø´Ø±Ø§Ù Ø§Ù„ØªÙˆØ¸ÙŠÙ</option>
    <option>Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© 1</option>
    <option>Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© 2</option>
    <option>Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© 3</option>
    <option>Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© 4</option>
    <option>Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© 5</option>
    <option>Ù†Ø§Ø¦Ø¨ Ù…Ø³Ø¤ÙˆÙ„ Ù…Ù‚Ø§Ø¨Ù„Ù‡ 1</option>
    <option>Ù†Ø§Ø¦Ø¨ Ù…Ø³Ø¤ÙˆÙ„ Ù…Ù‚Ø§Ø¨Ù„Ù‡ 2</option>
    <option>Ù†Ø§Ø¦Ø¨ Ù…Ø³Ø¤ÙˆÙ„ Ù…Ù‚Ø§Ø¨Ù„Ù‡ 3</option>
    <option>Ù†Ø§Ø¦Ø¨ Ù…Ø³Ø¤ÙˆÙ„ Ù…Ù‚Ø§Ø¨Ù„Ù‡ 4</option>
    <option>Ù†Ø§Ø¦Ø¨ Ù…Ø³Ø¤ÙˆÙ„ Ù…Ù‚Ø§Ø¨Ù„Ù‡ 5</option>
    <option>Ù…Ø³Ø¤ÙˆÙ„ ØªÙ†Ø¸ÙŠÙ… 1</option>
    <option>Ù…Ø³Ø¤ÙˆÙ„ ØªÙ†Ø¸ÙŠÙ… 2</option>
    <option>Ù…Ø³Ø¤ÙˆÙ„ ØªÙ†Ø¸ÙŠÙ… 3</option>
    <option>Ù…Ø³Ø¤ÙˆÙ„ ØªÙ†Ø¸ÙŠÙ… 4</option>
    <option>ØªÙ†Ø¸ÙŠÙ… 1</option>
    <option>ØªÙ†Ø¸ÙŠÙ… 2</option>
    <option>ØªÙ†Ø¸ÙŠÙ… 3</option>
    <option>ØªÙ†Ø¸ÙŠÙ… 4</option>
    <option>Ø¨Ø§Øµ 1</option>
    <option>Ø¨Ø§Øµ 2</option>
    <option>Ø¨Ø§Øµ 3</option>
    <option>Ø¨Ø§Øµ 4</option>
  </select>

  <button class="generate" onclick="generateNickname()">ğŸ— Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ø£Ø¸Ù‡Ø§Ø± Ø§Ø³Ù…Ùƒ ğŸ—</button>
  <div class="output" id="output"></div>
  <button class="copy-btn" onclick="copyText('output')">ğŸ”— Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù„Ù†Ø³Ø® ğŸ”—</button>
</div>

<script>
/* Helper utilities */
function isValidSelection(val) {
  return val && String(val).trim() !== "" && !String(val).trim().startsWith("Ø§Ø®ØªØ±");
}

function copyText(id) {
  const el = document.getElementById(id);
  if (!el) return;
  const text = el.innerText || el.textContent || "";
  if (!text.trim()) return;
  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(text).catch(()=>{});
  } else {
    const ta = document.createElement('textarea');
    ta.value = text;
    document.body.appendChild(ta);
    ta.select();
    try { document.execCommand('copy'); } catch(e){}
    ta.remove();
  }
}

/* Bracket helpers */
function parseBracketed(str){
  if (!str) return null;
  const m = /^\s*\[\s*([^\|\]\s]+)\s*\|\s*([^\]]*?)\s*\]\s*$/.exec(str);
  if (!m) return null;
  return { code: m[1], part: m[2] };
}
function makeBracketed(code, part){
  return `[ ${code} | ${part} ]`;
}
function formatNumberPart(s){
  const digits = String(s || "").replace(/[^0-9]/g, "");
  return digits ? ("G-" + digits) : "";
}

/* Tabs */
document.getElementById("fieldBtn").onclick = function(){
  document.getElementById("fieldContainer").classList.add("active");
  document.getElementById("jobContainer").classList.remove("active");
  this.classList.add("active");
  document.getElementById("jobBtn").classList.remove("active");
};
document.getElementById("jobBtn").onclick = function(){
  document.getElementById("jobContainer").classList.add("active");
  document.getElementById("fieldContainer").classList.remove("active");
  this.classList.add("active");
  document.getElementById("fieldBtn").classList.remove("active");
};

/* Setup */
document.addEventListener("DOMContentLoaded", function () {
  const rankSelect = document.getElementById("rankSelect");
  const fleetToggle = document.getElementById("fleetToggle");
  const fleetBox = document.getElementById("fleetBox");
  const minaTech = document.getElementById("minaTech");
  const masarat = document.getElementById("masarat");
  const masarInput = document.getElementById("masarInput");
  const controlUnit = document.getElementById("controlUnit");
  const controlOptions = document.getElementById("controlOptions");
  const koodToggle = document.getElementById("koodToggle");
  const koodOptions = document.getElementById("koodOptions");
  const numberField = document.getElementById("numberInputField");
  const numberFieldJob = document.getElementById("numberInput");

  /* Rank logic */
  if (rankSelect) {
    rankSelect.onchange = function () {
      const v = this.value;
      document.getElementById("subRegion").style.display = (v === "Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ù‡") ? "block" : "none";
      document.getElementById("subRegionTrainee").style.display = (v === "Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ù‡ Ù…ØªØ¯Ø±Ø¨") ? "block" : "none";
      document.getElementById("regionNames").style.display = (v === "ÙÙ†ÙŠ") ? "block" : "none";
    };
  }

  /* Fleet toggle */
  if (fleetToggle && fleetBox) {
    fleetToggle.onchange = function () {
      fleetBox.style.display = this.checked ? "block" : "none";
    };
    fleetBox.style.display = fleetToggle.checked ? "block" : "none";
  }

  /* MinaTech & Masarat mutual exclusion ONLY between themselves (not affecting kood) */
  if (minaTech) {
    minaTech.onchange = function () {
      if (this.checked && masarat) {
        masarat.checked = false;
        if (masarInput) masarInput.style.display = "none";
      }
    };
  }
  if (masarat) {
    masarat.onchange = function () {
      if (masarInput) masarInput.style.display = this.checked ? "block" : "none";
      if (this.checked && minaTech) minaTech.checked = false;
    };
    if (masarInput) masarInput.style.display = masarat.checked ? "block" : "none";
  }

  /* Control unit toggle */
  if (controlUnit && controlOptions) {
    controlUnit.onchange = function () {
      controlOptions.style.display = this.checked ? "block" : "none";
    };
    controlOptions.style.display = controlUnit.checked ? "block" : "none";
  }

  /* Kood independent toggle */
  if (koodToggle && koodOptions && numberField) {
    koodToggle.onchange = function () {
      koodOptions.style.display = this.checked ? "block" : "none";
      // Notice: we NO LONGER clear number field when unchecking
    };
    koodOptions.onchange = function () {
      const val = this.value;
      if (!val) return;
      const parsedNow = parseBracketed(numberField.value);
      const rawPart = parsedNow ? parsedNow.part : numberField.value;
      const formattedPart = formatNumberPart(rawPart) || "G-";
      numberField.value = makeBracketed(val, formattedPart);
    };
    koodOptions.style.display = koodToggle.checked ? "block" : "none";
  }

  /* Format number fields */
  function handleNumberFieldInput(el) {
    const parsed = parseBracketed(el.value);
    if (parsed) {
      const afterPipe = el.value.replace(/^\s*\[\s*[^\|\]\s]+\s*\|\s*/,'').replace(/\s*\]\s*$/,'');
      el.value = makeBracketed(parsed.code, formatNumberPart(afterPipe));
    } else {
      el.value = formatNumberPart(el.value);
    }
  }
  if (numberField) {
    numberField.oninput = function () { handleNumberFieldInput(this); };
    numberField.onpaste = function () { setTimeout(()=>handleNumberFieldInput(this), 0); };
  }
  if (numberFieldJob) {
    numberFieldJob.oninput = function () { this.value = formatNumberPart(this.value); };
    numberFieldJob.onpaste = function () { setTimeout(()=> { numberFieldJob.value = formatNumberPart(numberFieldJob.value); }, 0); };
  }
});

/* generateResult */
function generateResult() {
  const name = (document.getElementById("nameInputField").value || "").trim();
  const number = (document.getElementById("numberInputField").value || "").trim();
  const rank = document.getElementById("rankSelect").value;
  const subRegion = document.getElementById("subRegion").value;
  const subRegionTrainee = document.getElementById("subRegionTrainee").value;
  const regionName = document.getElementById("regionNames").value;
  const fleetChecked = document.getElementById("fleetToggle").checked;
  const fleetVal = document.getElementById("fleetBox").value;
  const minaTechChecked = document.getElementById("minaTech").checked;
  const masaratChecked = document.getElementById("masarat").checked;
  const masarVal = (document.getElementById("masarInput").value || "").trim();
  const controlChecked = document.getElementById("controlUnit").checked;
  const controlVal = document.getElementById("controlOptions").value;
  const koodChecked = document.getElementById("koodToggle").checked;
  const koodVal = document.getElementById("koodOptions").value;

  if (!name || !number) {
    document.getElementById("resultOutput").innerText = "ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ÙƒÙˆØ¯.";
    return;
  }

  const parts = [];
  if (!minaTechChecked && !masaratChecked) parts.push(name);
  parts.push(number);

  if (minaTechChecked) {
    parts.push("ÙÙ†ÙŠ Ù…ÙŠÙ†Ø§Ø¡");
  } else if (masaratChecked && masarVal) {
    parts.push("Ù…Ø³Ø§Ø± " + masarVal);
  } else {
    if (isValidSelection(rank)) {
      if (rank === "Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ù‡" && isValidSelection(subRegion)) {
        parts.push(subRegion);
      } else if (rank === "Ø§Ø´Ø±Ø§Ù Ù…Ù†Ø·Ù‚Ù‡ Ù…ØªØ¯Ø±Ø¨" && isValidSelection(subRegionTrainee)) {
        parts.push(subRegionTrainee);
      } else if (rank === "ÙÙ†ÙŠ" && isValidSelection(regionName)) {
        parts.push(regionName);
      } else if (rank !== "ÙÙ†ÙŠ") {
        parts.push(rank);
      }
    }
    if (fleetChecked && isValidSelection(fleetVal)) parts.push(fleetVal);
    if (controlChecked && isValidSelection(controlVal)) parts.push(controlVal);
  }

  // Kood is now completely independent â€” user can select it with anything else
  if (koodChecked && isValidSelection(koodVal)) {
    const parsedNumber = parseBracketed(number);
    if (!(parsedNumber && parsedNumber.code === koodVal)) {
      parts.push("ÙƒÙˆØ¯ " + koodVal);
    }
  }

  document.getElementById("resultOutput").innerText = parts.join(" | ");
}

/* generateNickname */
function generateNickname() {
  const name = (document.getElementById("nameInput").value || "").trim();
  const number = (document.getElementById("numberInput").value || "").trim();
  const role = document.getElementById("roleSelect").value;

  if (!name || !number || !isValidSelection(role)) {
    document.getElementById("output").innerText = "ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„.";
    return;
  }

  document.getElementById("output").innerText = [name, number, role].join(" | ");
}
</script>
